var saveAs=saveAs||function(e){"use strict";if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in r,i=/constructor/i.test(e.HTMLElement)||e.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent),s=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},u=function(e){setTimeout(function(){"string"==typeof e?n().revokeObjectURL(e):e.remove()},4e4)},d=function(e,t,n){for(var r=(t=[].concat(t)).length;r--;){var o=e["on"+t[r]];if("function"==typeof o)try{o.call(e,n||e)}catch(e){s(e)}}},f=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},c=function(t,s,c){c||(t=f(t));var l,p=this,h="application/octet-stream"===t.type,m=function(){d(p,"writestart progress write writeend".split(" "))};if(p.readyState=p.INIT,o)return l=n().createObjectURL(t),void setTimeout(function(){var e,t;r.href=l,r.download=s,e=r,t=new MouseEvent("click"),e.dispatchEvent(t),m(),u(l),p.readyState=p.DONE});!function(){if((a||h&&i)&&e.FileReader){var r=new FileReader;return r.onloadend=function(){var t=a?r.result:r.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,p.readyState=p.DONE,m()},r.readAsDataURL(t),void(p.readyState=p.INIT)}l||(l=n().createObjectURL(t)),h?e.location.href=l:e.open(l,"_blank")||(e.location.href=l);p.readyState=p.DONE,m(),u(l)}()},l=c.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=f(e)),navigator.msSaveOrOpenBlob(e,t)}:(l.abort=function(){},l.readyState=l.INIT=0,l.WRITING=1,l.DONE=2,l.error=l.onwritestart=l.onprogress=l.onwrite=l.onabort=l.onerror=l.onwriteend=null,function(e,t,n){return new c(e,t||e.name||"download",n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof module&&module.exports?module.exports.saveAs=saveAs:"undefined"!=typeof define&&null!==define&&null!==define.amd&&define("FileSaver.js",function(){return saveAs}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jsreport=t()}(this,function(){"use strict";function e(){this.options={},this.headers=this.headers||{}}function t(e){for(var t=new Uint8Array(e),n="",r=0;r<t.length;r++)n+=String.fromCharCode(t[r]);return n}function n(e,t){if(!this.serverUrl)throw new Error("The script was not linked from jsreport. You need to fill jsreport.serverUrl property with valid url to jsreport server.");t||(t=e,e="_blank"),("string"==typeof t||t instanceof String)&&(t={template:{shortid:t}}),t.template||(t={template:t}),function(e,t){var n=t||"_blank";if(t&&"_blank"!==t&&"_top"!==t&&"_parent"!==t&&"_self"!==t){if("string"==typeof t||t instanceof String){var r=document.getElementById("contentIframe");t=r?(r.contentDocument||r.contentWindow.document).getElementById(t):document.getElementById(t)}t.length&&(t=t[0]);var o="<iframe frameborder='0' name='"+(n=e.template.shortid||(new Date).getTime())+"' style='width:100%;height:100%;z-index:50'></iframe>";t.innerHTML=o}var i=document.createElement("form");function a(e,t,n){var r=document.createElement("input");r.type="hidden",r.name=t,r.value=n,e.appendChild(r)}function s(e,t){var n,r;if(void 0!==t)for(var o in t)n=t[o],r=void 0,"function"==(r=typeof n)||n&&"object"===r?(t[o]instanceof Array&&0===t[o].length&&a(i,e+"["+o+"]",[]),s(e+"["+o+"]",t[o])):void 0===t[o]||t[o]instanceof Array||a(i,e+"["+o+"]",t[o])}i.target=n,i.id=(new Date).getTime(),i.method="POST",i.action=this.serverUrl+"/api/report",s("template",e.template),null!=e.options&&s("options",e.options),e.data&&s("data",e.data);var u=this.headers;u["host-cookie"]=document.cookie,s("headers",u),document.body.appendChild(i),function e(t){if(t>10)return console.log("Unable to submit render form.");try{i.submit(),i.outerHTML=""}catch(n){setTimeout(function(){e(t+1)},50)}}(0)}.call(this,t,e)}function r(e){var t=this,n=new XMLHttpRequest;n.open(e.method,this.serverUrl+e.path,!0),n.setRequestHeader("Content-type","application/json; charset=utf-8"),Object.keys(this.headers).forEach(function(e){n.setRequestHeader(e,t.headers[e])});var r=this.promise||window.Promise||void 0;if(!r)throw new Error("Native Promise is not supported in this browser. Use jsreport.Promise = bluebirdOrAnyOtherLib;");return new r(function(t,r){n.onload=function(){if(this.status>=200&&this.status<300){if(n.response)return t(JSON.parse(n.response));t(n.response)}else r({status:this.status,statusText:n.statusText})},n.onerror=function(){r({status:this.status,statusText:n.statusText})},n.send(e.data?JSON.stringify(e.data):void 0)})}e.prototype={render:function(e,t){return n.call(this,e,t)},download:function(e,t){return t.options=t.options||{},t.options["Content-Disposition"]="attachment;filename="+e,n.call(this,"_self",t)},getTemplateByName:function(e){return r.call(this,{method:"GET",path:"/odata/templates?$filter=name"+encodeURI(" eq '"+e+"'")}).then(function(t){if(0===t.value.length)throw new Error("Template "+e+" not found");return t.value[0]})},updateTemplate:function(e){return r.call(this,{method:"PATCH",path:"/odata/templates("+e._id+")",data:e})},renderAsync:function(e){return function(e){var n=this;if(!this.serverUrl)throw new Error("The script was not linked from jsreport. You need to fill jsreport.serverUrl property with valid url to jsreport server.");e.template||(e={template:e});var r=new XMLHttpRequest,o=JSON.stringify(e);r.open("POST",this.serverUrl+"/api/report",!0),r.setRequestHeader("Content-type","application/json; charset=utf-8"),Object.keys(this.headers).forEach(function(e){r.setRequestHeader(e,n.headers[e])}),r.responseType="arraybuffer";var i=this.promise||window.Promise||void 0;if(!i)throw new Error("Native Promise is not supported in this browser. Use jsreport.Promise = bluebirdOrAnyOtherLib;");return new i(function(e,n){r.onload=function(){if(this.status>=200&&this.status<300){var o=r.response;o.toString=function(){return decodeURIComponent(escape(t(o)))},o.toDataURI=function(){return"data:"+r.getResponseHeader("Content-Type")+";base64, "+window.btoa(t(o))},o.toObjectURL=function(){return URL.createObjectURL(o.toBlob())},o.toBlob=function(){var e,t=r.getResponseHeader("Content-Type"),n=new DataView(o);try{e=new Blob([n],{type:t})}catch(n){if("InvalidStateError"!==n.name)throw n;var i=new Uint8Array(o);e=new Blob([i.buffer],{type:t})}return e},o.download=function(e){saveAs(o.toBlob(),e)},e(o)}else n({status:this.status,statusText:r.statusText})},r.onerror=function(){n({status:this.status,statusText:r.statusText})},r.send(o)})}.call(this,e)}};var o=new e;setTimeout(function(){void 0!==window.jsreportInit&&jsreportInit(o)},0);var i=Object.assign;return i||(i=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])}return t}),window.jsreport&&Object.assign(o,window.jsreport),o});